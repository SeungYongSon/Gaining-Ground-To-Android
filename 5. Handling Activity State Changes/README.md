# 5. 액티비티 상태 변화 처리하기

[안드로이드 애플리케이션과 액티비티 생명주기](https://github.com/SeungYongSon/Gaining-Ground-To-Android/tree/master/3.%20Android%20Application%20%26%20Activity%20Lifecycle) 에서 알 수 있듯  
애플리케이션이 존속하는 동안 애플리케이션을 구성하는 액티비티가 여러 다른 상태를 거친다는 점을 알았을 것이다.  
그리고 한 상태에서 다른 상태로의 변화는 안드로이드 런타임 시스템에 의해 수행되므로 액티비티 자신이 제어할 수 없다.  
몰론 대부분의 경우에 액티비티가 상황에 맞춰 반응할 시간적 여유를 주기 위해 런타임은 변화를 임박했음을 액티비티에게 알려준다.  
이때 액티비티에서는 자신의 내부 상태와 사용자 인터페이스 상태에 관련된 데이터를 저장하거나 복원한다.

이번 장에는 액티비티가 상태 변화에 따른 알림을 받는 방법과 상태 정보를 저장 및 복원하는 방법을 전반적으로 살펴볼 것이다. 그리고 추가적으로 액티비티 생애(activity lifetimes)에 대한 개념을 알아볼 것이다.

## 5-1. Activity 클래스

거의 예외 없이 애플리케이션의 액티비티들은 안드로이드 Activity 클래스 또는 Activity 클래스의 서브 클래스인 다른 클래스(예를들아, 하위 버전과의 호환성을 고려한 AppCompatActivity) 중 하나의 서브 클래스로 생성된다.

이해를 돕기위해 예시를 들어보자.

![AppCompatActivity를 상속 받음](image/ExtendAppCompatActivity.PNG "AppCompatActivity를 상속 받음")

위 사진은 MainActivity 라는 액티비티를 만들기 위해 AppCompatActivity 를 상속 받은 상태다.
안드로이드 편집기에서 계층 구조(Hierarchy) 도구를 사용해보자.

해당 클래스를 지정하고 Ctrl+H[Cmd+H] 단축키를 사용하도록하자.

![계층 도구 창 사용](image/UsingHierarchy.PNG "계층 도구 창 사용")

그럼 위와 같이 계층 구조 도구 창이 나타나면서 선택된 클래스 계층 구조를 보여줄 것이다.  
여기서 우릭 알 수 있는 점은 MainActivity 클래스는 AppCompatActivity 클래스의 서브 클래스 이면서  
또한 FragmentActivity 와 Activity 클래스의 서브 클래스인 것을 알 수 있다.

![3개의 버튼](image/ThreeBtn.PNG "3개의 버튼")
현재 선택된 첫 번째 버튼은 AppCompatActivity 의 모든 슈퍼 클래스들을 다 보여준다.  
두 번째 버튼은 바로 위 슈퍼 클래스, 다시말해 직계 부모 클래스를 보여준다.  
세 번째 버튼은 서브 클래스를 보여준다.  
(현재 MainActvity는 서브 클래스가 없어서 이 클래스만 나타난다.)

안드로이드에서는 크게 버젼이 바뀔 때마다 여러 새로운 기능이 추가되거나 UI(user interface)가 개선된다.  
이때 문제가 되는 것이 과거 버젼과의 호환성이다. 호환성 측면에서 고려할 두 가지 사항이 있다.  
다음 아래와 같다.

1. 과거 버젼의 애플리케이션(이하 앱)이 최신 버전의 안드로이드 시스템에서도 그대로 실행되는가?
2. 과거 버전의 안드로이드 시스템이 실행되는 장치에서도 최신 버전의 좋은 기능을 (다만 일부라도) 사용할 수 있는가?

결국 안드로이드는 그런 기능의 클래스들을 생성하여  
지원 라이브러리(support library)에 별도로 유지 및 관리하는 방법을 사용한다.  
그리고 그 클래스들은 기본 라이브러리 클래스의 서브 클래스로 생성되어 있다.